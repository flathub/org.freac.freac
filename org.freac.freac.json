{
    "app-id": "org.freac.freac",
    "runtime": "org.freedesktop.Platform",
    "runtime-version": "24.08",
    "sdk": "org.freedesktop.Sdk",
    "command": "freac",
    "finish-args": [
        "--device=all",
        "--filesystem=host",
        "--share=ipc",
        "--share=network",
        "--socket=pulseaudio",
        "--socket=x11",
        "--metadata=X-DConf=migrate-path=/org/freac/freac/"
    ],
    "cleanup": [
        "/bin/mac",
        "/include",
        "/lib/pkgconfig",
        "/share/aclocal",
        "/share/info",
        "/share/man",
        "*.a",
        "*.la"
    ],
    "modules": [
        "shared-modules/mac/mac.json",
        {
            "name": "libcdio",
            "config-opts": [
                "--disable-cxx",
                "--disable-example-progs",
                "--without-cd-drive",
                "--without-cd-info",
                "--without-cd-read",
                "--without-cdda-player",
                "--without-iso-info",
                "--without-iso-read"
            ],
            "cleanup": [
                "/bin/mmc-tool",
                "/lib/libiso9660.*",
                "/lib/libudf.*"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/gnu/libcdio/libcdio-2.1.0.tar.bz2",
                    "sha256": "8550e9589dbd594bfac93b81ecf129b1dc9d0d51e90f9696f1b2f9b2af32712b"
                }
            ]
        },
        {
            "name": "libcdio-paranoia",
            "config-opts": [
                "--disable-cxx",
                "--disable-example-progs"
            ],
            "cleanup": [
                "/bin/cd-paranoia"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/libcdio/libcdio-paranoia/archive/refs/tags/release-10.2+2.0.2.tar.gz",
                    "sha256": "fe35208811f3edfcb79ae7b4ad1984f3188aea42c4c8ba4d009efafb36734a8b"
                }
            ]
        },
        {
            "name": "libmp4v2",
            "cleanup": [
                "/bin/mp4*"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/enzo1982/mp4v2/releases/download/v2.1.3/mp4v2-2.1.3.tar.bz2",
                    "sha256": "033185c17bf3c5fdd94020c95f8325be2e5356558e3913c3d6547a85dd61f7f1"
                }
            ]
        },
        {
            "name": "liburiparser",
            "buildsystem": "cmake",
            "config-opts": [
                "-DURIPARSER_BUILD_DOCS=OFF",
                "-DURIPARSER_BUILD_TESTS=OFF"
            ],
            "cleanup": [
                "/bin/uriparse"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/uriparser/uriparser/releases/download/uriparser-0.9.8/uriparser-0.9.8.tar.xz",
                    "sha256": "1d71c054837ea32a31e462bce5a1af272379ecf511e33448e88100b87ff73b2e"
                }
            ]
        },
        {
            "name": "musepack",
            "build-options": {
                "cflags": "-Wno-incompatible-pointer-types"
            },
            "config-opts": [
                "--disable-shared"
            ],
            "cleanup": [
                "/bin/mpc2sv8",
                "/bin/mpccut",
                "/bin/wavcmp"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.musepack.net/source/musepack_src_r475.tar.gz",
                    "sha256": "a4b1742f997f83e1056142d556a8c20845ba764b70365ff9ccf2e3f81c427b2b"
                },
                {
                    "type": "patch",
                    "path": "patches/musepack_src_r475-const.patch"
                },
                {
                    "type": "shell",
                    "commands": [
                        "touch include/config.h.in",
                        "head -n 34 configure.in >> configure.ac",
                        "echo \"AM_CONDITIONAL([HAVE_VISIBILITY], [false])\" >> configure.ac",
                        "echo \"AC_CHECK_LIB([m],[cos])\" >> configure.ac",
                        "tail -n 18 configure.in >> configure.ac",
                        "rm configure.in",
                        "autoreconf -i"
                    ]
                }
            ]
        },
        {
            "name": "rnnoise",
            "cleanup": [
                "/share/doc/rnnoise"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/xiph/rnnoise.git",
                    "commit": "372f7b4b76cde4ca1ec4605353dd17898a99de38"
                },
                {
                    "type": "file",
                    "url": "https://media.xiph.org/rnnoise/models/rnnoise_data-0b50c45.tar.gz",
                    "sha256": "4ac81c5c0884ec4bd5907026aaae16209b7b76cd9d7f71af582094a2f98f4b43"
                }
            ]
        },
        {
            "name": "rubberband",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://breakfastquay.com/files/releases/rubberband-4.0.0.tar.bz2",
                    "sha256": "af050313ee63bc18b35b2e064e5dce05b276aaf6d1aa2b8a82ced1fe2f8028e9"
                }
            ]
        },
        {
            "name": "smooth",
            "no-autogen": true,
            "make-install-args": [ "prefix=/app" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/enzo1982/smooth/releases/download/v0.9.10/smooth-0.9.10.tar.gz",
                    "sha256": "c018ea09eb4e269268cb123bb5d24a813d07c985384c5384d7fa73b7173e9f1c"
                }
            ]
        },
        {
            "name": "BoCA",
            "no-autogen": true,
            "make-install-args": [ "prefix=/app" ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/enzo1982/BoCA/releases/download/v1.0.7/boca-1.0.7.tar.gz",
                    "sha256": "2433f2752e1441f6270460f5f2acb99de67b269e494559134e3ab26173222c7e"
                }
            ]
        },
        {
            "name": "freac",
            "no-autogen": true,
            "make-install-args": [ "prefix=/app" ],
            "build-options": {
                "cxxflags": "-DFREAC_DATE=\\\"20230305\\\""
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/enzo1982/freac/releases/download/v1.1.7/freac-1.1.7.tar.gz",
                    "sha256": "617d51759315f65e387fcaf1f1b455c97a2fb53bfdbd2521c9c586b3271f3528"
                },
                {
                    "type": "patch",
                    "path": "patches/freac-1.1-beta-noudev.patch"
                },
                {
                    "type": "patch",
                    "path": "patches/appstream.patch"
                }
            ]
        }
    ]
}
